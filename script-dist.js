"use strict";function draw(){var a=canvas.node().getContext("2d");a.save(),a.clearRect(0,0,width,height);for(var n=0;n<points.length;++n){var t=points[n];a.fillStyle=t.color,a.fillRect(t.x,t.y,pointWidth,pointWidth)}a.restore()}function animate(a){points.forEach(function(a){a.sx=a.x,a.sy=a.y}),a(points),points.forEach(function(a){a.tx=a.x,a.ty=a.y}),timer=d3.timer(function(a){var n=Math.min(1,ease(a/duration));points.forEach(function(a){a.x=a.sx*(1-n)+a.tx*n,a.y=a.sy*(1-n)+a.ty*n}),draw(),1===n&&(timer.stop(),currLayout=(currLayout+1)%layouts.length,animate(layouts[currLayout]))})}for(var width=600,height=600,numPoints=64e3,pointWidth=1,pointMargin=3,duration=4e3,ease=d3.easeCubic,timer=void 0,currLayout=0,points=createPoints(numPoints,pointWidth,width,height),flower_f=[76,68,58,66,84,94,86,78,60,50,40,48,56,74,92,102,112,104,96,70,52,42,32,22,30,38,46,64,82,100,110,120,130,122,114,106,88,80,62,44,34,24,14,4,12,20,28,36,54,72,90,108,118,128,138,148,140,132,124,116,98],radius=height/10-.4*pointWidth,gridXOffset=Math.sqrt(Math.pow(radius,2)-Math.pow(radius/2,2)),gridYOffset=radius/2,matrix=[],k=1;k<18;k++)for(var j=1;j<10;j++){var x=j*gridXOffset,y=k*gridYOffset;matrix.push([x,y])}var flower_1=flower_f.slice(0,1),flower_2=flower_f.slice(0,7),flower_3=flower_f.slice(0,19),flower_4=flower_f.slice(0,37),toFlower_f=function(a){return flowerLayout(a,pointWidth+pointMargin,width,height,matrix,flower_f,radius)},toFlower_1=function(a){return flowerLayout(a,pointWidth+pointMargin,width,height,matrix,flower_1,radius)},toFlower_2=function(a){return flowerLayout(a,pointWidth+pointMargin,width,height,matrix,flower_2,radius)},toFlower_3=function(a){return flowerLayout(a,pointWidth+pointMargin,width,height,matrix,flower_3,radius)},toFlower_4=function(a){return flowerLayout(a,pointWidth+pointMargin,width,height,matrix,flower_4,radius)},tree_radius=height/30,tree_circles=[76,68,66,84,86,94,50,40,48,112],toTree=function(a){return treeLayout(a,pointWidth+pointMargin,width,height,matrix,tree_circles,tree_radius)},meta_circles=[76,60,40,56,92,112,,96,44,4,36,108,148,116],toMeta=function(a){return metaLayout(a,pointWidth+pointMargin,width,height,matrix,meta_circles,radius)},toPhyllotaxis=function(a){return phyllotaxisLayout(a,pointWidth+pointMargin,width/2,height/2)},layouts=[toTree,toFlower_3,toFlower_f,toPhyllotaxis,toFlower_f,toMeta],screenScale=window.devicePixelRatio||1,canvas=d3.select("body").append("canvas").attr("width",width*screenScale).attr("height",height*screenScale).style("width",width+"px").style("height",height+"px").on("click",function(){d3.select(".play-control").style("display",""),timer.stop()});canvas.node().getContext("2d").scale(screenScale,screenScale),toMeta(points),draw(),d3.select("body").append("div").attr("class","play-control").text("PLAY").on("click",function(){animate(layouts[currLayout]),d3.select(this).style("display","none")});